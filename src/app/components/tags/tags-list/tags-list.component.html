<div class="tags-container">
  <h2>Tags</h2>
  <button class="btn-novo" (click)="openModal()">Nova Tag</button>

  <!-- SeÃ§Ã£o de seleÃ§Ã£o/ busca por ID -->
  <section class="search-section">
    <div class="search-box">
      <!-- input readonly mostrando o nome da tag -->
      <input
        type="text"
        class="form-control"
        [value]="getTagNomeSelecionada()"
        readonly
      />
      <button class="btn btn-outline-primary" (click)="abrirModalSelecionarTag()">
        Selecionar Tag
      </button>
      <button class="search-button" (click)="getTagById()">Buscar</button>
    </div>
  </section>

  <!-- Resultado da busca por ID -->
  @if (tagEncontrada) {
    <div class="result-list">
      <h3>Tag Encontrada</h3>
      <div class="meta-card">
        <p><strong>ID:</strong> {{ tagEncontrada.id }}</p>
        <p><strong>Nome:</strong> {{ tagEncontrada.nome }}</p>
      </div>
    </div>
  }

  <!-- Tabela -->
  @if (tags.length > 0) {
    <table mat-table [dataSource]="tags" class="mat-elevation-z8">
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>ID</th>
        <td mat-cell *matCellDef="let tag">{{ tag.id }}</td>
      </ng-container>
      <ng-container matColumnDef="nome">
        <th mat-header-cell *matHeaderCellDef>Nome</th>
        <td mat-cell *matCellDef="let tag">{{ tag.nome }}</td>
      </ng-container>
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>AÃ§Ãµes</th>
        <td mat-cell *matCellDef="let tag">
          <button mat-icon-button color="primary" (click)="openModal(tag)">
            <mat-icon>âœï¸</mat-icon>
          </button>
          <button mat-icon-button color="warn" (click)="deleteTag(tag.id!)">
            <mat-icon>ğŸ—‘ï¸</mat-icon>
          </button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  }

  <!-- Modal de SeleÃ§Ã£o de Tag -->
  <ng-template #modalSelecionarTag let-modal>
    <div class="modal-header">
      <h5 class="modal-title">Selecionar Tag</h5>
      <button type="button" class="btn-close" (click)="modal.close()"></button>
    </div>
    <div class="modal-body p-0">
      <ul class="list-group list-group-flush">
        @for (t of tags; track t.id) {
          <li
            class="list-group-item list-group-item-action"
            (click)="selecionarTag(t)"
          >
            {{ t.nome }}
          </li>
        }
      </ul>
    </div>
  </ng-template>
</div>
